function isA(e,t){return Object.prototype.toString.apply(t)==="[object "+e+"]"}function getType(e){return isA("RegExp",e)?"regexp":isA("Array",e)?"array":isA("Function",e)?"function":isA("Object",e)?"object":isA("Number",e)||isA("String",e)?"constant":null}function makeComponent(e){switch(e.type){case"object":return{};case"array":return[];case"regexp":return new RegExp;case"constant":return e.value;case"function":var t,n,r=[],o=!1,a=[],i=[],c=e.members&&e.members.prototype&&e.members.prototype.members||{},u=function(){if(global.dirtyMocks.push(u),i.push(this),a.push(Array.prototype.slice.call(arguments)),this instanceof arguments.callee){for(var e in c)if("function"==c[e].type){var m=this[e];this[e]=generateFromMetadata(c[e]),this[e]._protoImpl=m}return void(n&&n.apply(this,arguments))}var s;return o&&(s=r.shift(),void 0===s&&(s=t)),n&&void 0===s?n.apply(this,arguments):void 0===s&&arguments.callee._protoImpl?arguments.callee._protoImpl.apply(this,arguments):s};return u._isMockFunction=!0,u.mock={calls:a,instances:i},u.mockClear=function(){a.length=0,i.length=0},u.mockReturnValueOnce=function(e){return o=!0,r.push(e),u},u.mockReturnValue=function(e){return o=!0,t=e,u},u.mockImplementation=function(e){return o=!1,n=e,u},u.mockReturnThis=function(){return u.mockImplementation(function(){return this})},u._getMockImplementation=function(){return n},e.mockImpl&&u.mockImplementation(e.mockImpl),u}throw new Error("Unrecognized type "+e.type)}function generateFromMetadata(e){function t(e){function o(e,t){return function(){a[e]=r[t]}}var a=makeComponent(e);null!=e.ref_id&&(r[e.ref_id]=a);for(var i in e.members){var c=e.members[i];null!=c.ref?n.push(o(i,c.ref)):a[i]=t(c)}return a}var n=[],r={},o=t(e);return n.forEach(function(e){e()}),o}function _getMetadata(e,t){function n(e,t){t&&(c||(c={}),c[e]=t)}var r=t||[],o=r.indexOf(e);if(o>-1)return{ref:o};var a=getType(e);if(!a)return null;var i={type:a};if("constant"==a)return i.value=e,i;"function"==a&&e._isMockFunction&&(i.mockImpl=e._getMockImplementation()),i.ref_id=r.length,r.push(e);var c=null;if("array"!=a){for(var u in e)"_"==u.charAt(0)||"function"==a&&e._isMockFunction&&u.match(/^mock/)||(e.hasOwnProperty(u)||"object"==a&&e[u]!=Object.prototype[u])&&n(u,_getMetadata(e[u],r));if("function"==a&&e.prototype){var m=_getMetadata(e.prototype,r);m&&m.members&&n("prototype",m)}}return c&&(i.members=c),i}function removeUnusedRefs(e){function t(e,n){if(n(e),e.members)for(var r in e.members)t(e.members[r],n)}var n={};t(e,function(e){null!=e.ref&&(n[e.ref]=!0)}),t(e,function(e){n[e.ref_id]||delete e.ref_id})}var global=Function("return this")();global.dirtyMocks=global.dirtyMocks||[],module.exports={clear:function(){var e=global.dirtyMocks;global.dirtyMocks=[],e.forEach(function(e){e.mockClear()})},generateFromMetadata:generateFromMetadata,getMetadata:function(e){var t=_getMetadata(e);return removeUnusedRefs(t),t},getMockFunction:function(){return makeComponent({type:"function"})}};
//# sourceMappingURL=mocks.js.map